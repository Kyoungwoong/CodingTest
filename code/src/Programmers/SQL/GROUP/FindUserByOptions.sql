-- 코드를 입력하세요
-- SELECT U.USER_ID, U.NICKNAME, B.TOTAL_PRICE
-- FROM USED_GOODS_USER U JOIN (
--         SELECT WRITER_ID, SUM(PRICE) AS TOTAL_PRICE
--         FROM USED_GOODS_BOARD
--         WHERE STATUS = 'DONE'
--         GROUP BY WRITER_ID
--         HAVING SUM(PRICE) >= 700000
--     ) B ON U.USER_ID = B.WRITER_ID
-- ORDER BY B.TOTAL_PRICE;

-- SELECT USER_ID, NICKNAME, TOTAL_SALES
-- FROM USED_GOODS_USER U JOIN (
--         SELECT WRITER_ID, SUM(PRICE) AS TOTAL_SALES
--         FROM USED_GOODS_BOARD
--         WHERE STATUS = 'DONE'
--         GROUP BY WRITER_ID
--         HAVING SUM(PRICE) >= 700000
--     ) B ON B.WRITER_ID = U.USER_ID
-- ORDER BY B.TOTAL_SALES;

-- 10/24
SELECT
    U.USER_ID,
    U.NICKNAME,
    R.TOTAL_SALES
FROM USED_GOODS_USER U JOIN (
    SELECT
        WRITER_ID,
        SUM(PRICE) AS TOTAL_SALES
    FROM USED_GOODS_BOARD B
    WHERE B.STATUS = 'DONE'
    GROUP BY WRITER_ID
    HAVING SUM(PRICE) >= 700000
)R ON U.USER_ID = R.WRITER_ID
ORDER BY R.TOTAL_SALES











