package SWExpert.DP;

import java.util.*;

public class TSP {
    static int N;
    static int[][] dist;
    static int[][] dp;
    static final int INF = Integer.MAX_VALUE / 2;

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        N = sc.nextInt();
        dist = new int[N][N];
        dp = new int[N][1 << N];

        // ê±°ë¦¬ ìž…ë ¥
        for (int i = 0; i < N; i++)
            for (int j = 0; j < N; j++)
                dist[i][j] = sc.nextInt();

        // DP ì´ˆê¸°í™”
        for (int i = 0; i < N; i++)
            Arrays.fill(dp[i], -1);

        int result = tsp(0, 1); // 0ë²ˆ ë„ì‹œë¶€í„° ì‹œìž‘, 0ë²ˆ ë„ì‹œë§Œ ë°©ë¬¸í•œ ìƒíƒœ
        for (int i = 0; i < N; i++) {
            for (int j = 0; j < 1 << N; j++) {
                System.out.print(dp[i][j] + " ");
            }
            System.out.println();
        }
        System.out.println("ìµœì†Œ ë¹„ìš©: " + result);
    }

    // í˜„ìž¬ ë„ì‹œ current, ë°©ë¬¸í•œ ë„ì‹œ ìƒíƒœ visited(bitmask)
    static int tsp(int current, int visited) {
//        System.out.println("current: " + current + " visited: " + visited);
        if (visited == (1 << N) - 1) {
            // ëª¨ë“  ë„ì‹œ ë°©ë¬¸ â†’ ì‹œìž‘ì ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            return dist[current][0] == 0 ? INF : dist[current][0];
        }

        if (dp[current][visited] != -1) return dp[current][visited];

        int min = INF;
        for (int next = 0; next < N; next++) {
            if ((visited & (1 << next)) == 0 && dist[current][next] != 0) {
                int cost = dist[current][next] + tsp(next, visited | (1 << next));
                min = Math.min(min, cost);
            }
        }

        return dp[current][visited] = min;
    }
}

/*
4
0 10 15 20
10 0 35 25
15 35 0 30
20 25 30 0
 */

/**
 * ë¬¸ì œ ê°œë… ìš”ì•½
 * ëª©í‘œ:
 * Nê°œì˜ ë„ì‹œê°€ ìžˆê³ , ê° ë„ì‹œ ì‚¬ì´ì˜ ì´ë™ ë¹„ìš©ì´ ì£¼ì–´ì¡Œì„ ë•Œ,
 * ëª¨ë“  ë„ì‹œë¥¼ í•œ ë²ˆì”©ë§Œ ë°©ë¬¸í•˜ê³ ,
 * ë‹¤ì‹œ ì‹œìž‘í•œ ë„ì‹œë¡œ ëŒì•„ì˜¤ëŠ” ìµœì†Œ ë¹„ìš©ì„ êµ¬í•˜ëŠ” ë¬¸ì œìž…ë‹ˆë‹¤.
 *
 * ì˜ˆë¥¼ ë“¤ì–´
 * A â†’ B â†’ C â†’ D â†’ A ë¡œ ìˆœíšŒí•  ë•Œì˜ ìµœì†Œ ë¹„ìš©ì„ êµ¬í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤.
 * ì´ê±´ ì™„ì „íƒìƒ‰(ëª¨ë“  ìˆœì—´ íƒìƒ‰)ìœ¼ë¡œ í’€ ìˆ˜ ìžˆì§€ë§Œ, ë„ì‹œ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ë©´ ë„ˆë¬´ ì˜¤ëž˜ ê±¸ë¦½ë‹ˆë‹¤.
 * â†’ ê·¸ëž˜ì„œ ë™ì ê³„íšë²• + ë¹„íŠ¸ë§ˆìŠ¤í‚¹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
 *
 * âœ… ê¸°ë³¸ ì•„ì´ë””ì–´
 * ìš°ë¦¬ëŠ” ë‹¤ìŒ ë‘ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ê³„ì‚°ì„ í”¼í•˜ë©´ì„œ ê²½ë¡œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
 *
 * í˜„ìž¬ ìœ„ì¹˜í•œ ë„ì‹œ: current
 *
 * ì§€ê¸ˆê¹Œì§€ ë°©ë¬¸í•œ ë„ì‹œë“¤: visited (bitmaskë¡œ í‘œí˜„)
 *
 * â†’ dp[current][visited]ë¥¼ ë©”ëª¨ì´ì œì´ì…˜ í…Œì´ë¸”ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
 * â†’ dp[i][mask]ëŠ”:
 *
 * i ë„ì‹œì—ì„œ ì‹œìž‘í•´ì„œ,
 * maskë¡œ í‘œí˜„ëœ ë„ì‹œë“¤ì„ ì´ë¯¸ ë°©ë¬¸í–ˆì„ ë•Œ
 * ë‚¨ì€ ëª¨ë“  ë„ì‹œë¥¼ ë°©ë¬¸í•˜ê³  ì‹œìž‘ì ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ìµœì†Œ ë¹„ìš©
 *
 * âœ… ìš©ì–´ í•´ì„¤
 * ðŸ“Œ ë¹„íŠ¸ë§ˆìŠ¤í‚¹ì´ëž€?
 * ë„ì‹œê°€ 4ê°œ ìžˆë‹¤ê³  í•´ë´…ì‹œë‹¤.
 *
 * 0001 : 0ë²ˆ ë„ì‹œë§Œ ë°©ë¬¸
 *
 * 0011 : 0ë²ˆ, 1ë²ˆ ë„ì‹œ ë°©ë¬¸
 *
 * 1111 : ëª¨ë“  ë„ì‹œ ë°©ë¬¸ (ì¢…ë£Œ ì¡°ê±´)
 *
 * ðŸ“Œ ì í™”ì‹ êµ¬ì„±
 * java
 * ì½”ë“œ ë³µì‚¬
 * tsp(current, visited)
 * í˜„ìž¬ ìœ„ì¹˜í•œ ë„ì‹œ: current
 *
 * ë°©ë¬¸í•œ ë„ì‹œ: visited (bitmaskë¡œ í‘œí˜„ë¨)
 *
 * ë‹¤ìŒ ë„ì‹œ nextë¥¼ ì •í•´ì£¼ê³ ,
 * ì´ë™í•´ì„œ ì–»ì„ ìˆ˜ ìžˆëŠ” ë¹„ìš© + ë‚¨ì€ ê²½ë¡œì˜ ìµœì†Œ ë¹„ìš©ì„ êµ¬í•©ë‹ˆë‹¤.
 *
 * âœ… ì•Œê³ ë¦¬ì¦˜ íë¦„ ì„¤ëª…
 * ðŸ”· 1. ìž…ë ¥ ë° ì´ˆê¸°í™”
 * java
 * ì½”ë“œ ë³µì‚¬
 * N = sc.nextInt();                      // ë„ì‹œ ìˆ˜
 * dist = new int[N][N];                 // ê±°ë¦¬ ë°°ì—´
 * dp = new int[N][1 << N];             // DP í…Œì´ë¸” (ë„ì‹œ, ë°©ë¬¸ ìƒíƒœ)
 *
 * for (int i = 0; i < N; i++)
 *     Arrays.fill(dp[i], -1);          // -1ë¡œ ì´ˆê¸°í™” (ì•„ì§ ê³„ì‚° ì•ˆ í–ˆë‹¤ëŠ” ëœ»)
 * ðŸ”· 2. ì‹œìž‘: ë„ì‹œ 0ì—ì„œ ì¶œë°œ
 * java
 * ì½”ë“œ ë³µì‚¬
 * int result = tsp(0, 1); // 0ë²ˆ ë„ì‹œì—ì„œ ì‹œìž‘í–ˆê³ , 0ë²ˆ ë„ì‹œë§Œ ë°©ë¬¸í•œ ìƒíƒœ
 * ðŸ”· 3. ìž¬ê·€ í•¨ìˆ˜ tsp(current, visited)
 * java
 * ì½”ë“œ ë³µì‚¬
 * // ëª¨ë“  ë„ì‹œë¥¼ ë‹¤ ë°©ë¬¸í–ˆë‹¤ë©´?
 * if (visited == (1 << N) - 1) {
 *     return dist[current][0]; // ì‹œìž‘ ë„ì‹œë¡œ ëŒì•„ê°€ëŠ” ë¹„ìš©
 * }
 * âœ” ë¹„íŠ¸ë§ˆìŠ¤í¬ ì˜ˆì‹œ (N = 4):
 * ìƒíƒœ	visited (ì´ì§„ìˆ˜)	ì˜ë¯¸
 * 1	0001	0ë²ˆ ë„ì‹œë§Œ ë°©ë¬¸
 * 3	0011	0ë²ˆ, 1ë²ˆ ë„ì‹œ ë°©ë¬¸
 * 15	1111	0,1,2,3 ì „ë¶€ ë°©ë¬¸ ì™„ë£Œ
 *
 * ðŸ”· 4. ë‹¤ìŒ ë„ì‹œë¡œ ì´ë™
 * java
 * ì½”ë“œ ë³µì‚¬
 * for (int next = 0; next < N; next++) {
 *     // ë°©ë¬¸ ì•ˆ í–ˆê³ , ê¸¸ì´ ì¡´ìž¬í•˜ëŠ” ê²½ìš°
 *     if ((visited & (1 << next)) == 0 && dist[current][next] != 0) {
 *         int cost = dist[current][next] + tsp(next, visited | (1 << next));
 *         min = Math.min(min, cost);
 *     }
 * }
 * ðŸ”¸ ì„¤ëª…:
 * (visited & (1 << next)) == 0
 * â†’ ì•„ì§ next ë„ì‹œë¥¼ ë°©ë¬¸í•˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
 *
 * visited | (1 << next)
 * â†’ next ë„ì‹œë¥¼ ë°©ë¬¸í–ˆë‹¤ê³  ìƒíƒœ ì—…ë°ì´íŠ¸
 *
 * ðŸ”· 5. ê²°ê³¼ ì €ìž¥ (ë©”ëª¨ì´ì œì´ì…˜)
 * java
 * ì½”ë“œ ë³µì‚¬
 * return dp[current][visited] = min;
 * ì´ë¯¸ ê³„ì‚°í•œ ê°’ì€ ë‹¤ì‹œ ê³„ì‚°í•˜ì§€ ì•Šê³  ì‚¬ìš©í•©ë‹ˆë‹¤.
 *
 * âœ… ì‹œê°í™” ì˜ˆì‹œ
 * ì˜ˆ: ë„ì‹œ 4ê°œ, ê±°ë¦¬í–‰ë ¬
 *
 * ì½”ë“œ ë³µì‚¬
 * 0 10 15 20
 * 10 0 35 25
 * 15 35 0 30
 * 20 25 30 0
 * ì‹œìž‘: 0 â†’ 1 â†’ 3 â†’ 2 â†’ 0
 *
 * ìµœì†Œ ë¹„ìš© ê²½ë¡œ ì¤‘ í•˜ë‚˜ì´ë©°, ê²°ê³¼ëŠ” 80ì´ ë©ë‹ˆë‹¤.
 *
 * âœ… ì‹œê°„ ë³µìž¡ë„
 * ë„ì‹œ ê°œìˆ˜ Nì¼ ë•Œ:
 *
 * DP ë°°ì—´ í¬ê¸°: N * 2^N
 * ê° ìƒíƒœë§ˆë‹¤ O(N)ë§Œí¼ íƒìƒ‰ â†’
 * ì´ ì‹œê°„ ë³µìž¡ë„: O(N^2 * 2^N)
 *
 * â†’ ë³´í†µ N â‰¤ 16ì¼ ë•Œ ì‹¤ìš©ì ìž…ë‹ˆë‹¤.
 */